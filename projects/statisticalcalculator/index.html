<html>

<head>
    <title>Statistical Calculator</title>
    <link rel="icon" href="assets/img/logo_statistics.png">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1">
    <script src="assets/js/test_paired.js" type="text/javascript"></script>
    <script src="assets/js/test_independent.js" type="text/javascript"></script>
    <script src="assets/js/test_one_way.js" type="text/javascript"></script>
    <script src="assets/js/t-table.js" type="text/javascript"></script>
    <script src="assets/js/f-table.js" type="text/javascript"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-920RE3KPW7"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-920RE3KPW7');
        gtag('config', 'UA-118016609-1');
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <style>
        @media (min-width: 576px) {

            .container,
            .container-sm {
                max-width: 600px !important;
                width: 100% !important;
            }
        }

        @media screen and (max-width: 800px) {
            .content_header {
                width: 100% !important;
            }

            .content {
                width: 100% !important;
            }

            .footer {
                width: 100% !important;
            }

            .container {
                margin-top: 0 !important;
            }

            .h1,
            h1 {
                font-size: 2.0rem;
                /* font-size: 2.5rem; */
            }

            .content_header {
                width: 100%;
            }



        }

        .content_header {
            width: 600px;
        }

        .content {
            width: 600px;
        }

        .footer {
            width: 600px;
        }

        div#step3_output {
            display: none;
        }

        div#resources {
            display: none;
        }
    </style>
</head>

<body>
    <div class="container mt-3">
        <div class="row justify-content-center text-white">
            <div class="content_header bg-primary p-3 text-center">
                <h1 style="filter: drop-shadow(3px 4px 5px black);">Statistical Calculator<img
                        src="assets/img/logo_statistics.png"
                        style="filter: invert(1);" width="50px" height="50px" class="mt-1 mb-2 ml-1" /></h1>
               
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="content bg-light p-3">
                <div id="description_hello">
                    <h5>About this web application</h3>
                        This is a free-to-use, no-download online resource to perform statistical analysis.
                        It was designed for introduction to statistics students as a mobile-friendly learning aid and
                        convenient homework check.
                        <br /><br />
                        This current version only computes parametric t-tests. Accuracy of formulas were successfully
                        verified against online t-test calculators from socscistatistics.com and
                        graphpad.com.<br /><br />
                        <div id="accordion" class="mb-1">
                            <div class="card">
                                <div class="card-header" id="headingTwo">
                                    <h5 class="mb-0">
                                        <button class="btn btn-link text-danger" data-toggle="collapse"
                                            data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                                            What kind of results does this calculator output?
                                        </button>
                                    </h5>
                                </div>

                                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo"
                                    data-parent="#accordion">
                                    <div class="card-body">
                                        The results outputs: descriptive statistics (e.g., group sum, means, variance,
                                        sd), t-statistics, t-crit, effect size, null and alternative hypothesis test,
                                        and a "report your results". The next version will include confidence intervals
                                        and exact p-values.
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="accordion">
                            <div class="card">
                                <div class="card-header" id="headingOne">
                                    <h5 class="mb-0">
                                        <button class="btn btn-link text-danger" data-toggle="collapse"
                                            data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                            What does this calculator assume, statistically?
                                        </button>
                                    </h5>
                                </div>

                                <div id="collapseOne" class="collapse" aria-labelledby="headingOne"
                                    data-parent="#accordion">
                                    <div class="card-body">
                                        Here is what this statistical calculator assumes:<br />
                                        <ol>
                                            <li>Homogeneity samples (i.e., equal variance)</li>
                                            <li>Normal population distrubtion (i.e., normality)</li>
                                            <li>Data is independent (i.e., random sampling)</li>
                                        </ol>
                                        In other words, this calculator, in its current version, was not designed to
                                        test all the assumptions of the t-test nor to conduct non-parametric analysis.
                                        The <em>only exception</em> is the F-test automatically computed during an
                                        independent sample t-test analysis to determine whether a student's t-test or
                                        Welch's t-test should be performed based on whether the samples have equal
                                        variances.
                                        <br /><br />
                                        In addition to this applicaton assuming all three above assumptions have been
                                        met, the t-distribution table is used for all t-statistics, t-crit values, and
                                        null hypothesis computations.
                                    </div>
                                </div>
                            </div>
                        </div>



                        <br />
                </div>
                <div id="step1_instructions">
                    <b>Instructions:</b> Input the parameters of your t-test. After you click "generate data entry
                    table", you can enter the scores for the group(s).
                    <br />
                    <!---
<label for="fname">Max number of participants (or entries) in <u>total</u>:</label>
<input type="text" id="total">
<br />
--->
                    <div class="card mt-2">
                        <div class="card-body">
                            <form name="myForm">
                                <label for="test_type">Choose the type of t-test:</label>
                                <select id="test_type" class="form-control">
                                    <option value="independent">Independent (Unpaired) sample t-test</option>
                                    <option value="one_way">One sample t-test</option>
                                    <option value="paired">Paired t-test</option>
                                </select>
                                <label for="fname">What is the largest size (n = ?) of any one of your
                                    group(s)?:</label>
                                <input type="text" name="group_size" id="group" class="form-control"
                                    placeholder="This will generate the appropiate number of rows for data entry">
                                <label for="p_value">Choose the significance level (alpha level):</label>
                                <select id="p_value" class="form-control">
                                    <option value="05">.05</option>
                                    <option value="10">.10</option>
                                    <option value="01">.01</option>
                                    <option value="001">.001</option>
                                </select>
                                <label for="p_value">Is this a one tail or two-tail t-test?:</label>

                                <select id="tail_type" class="form-control">
                                    <option value="tail_two">Two tail</option>
                                    <option value="tail_one_left">One tail (Left)</option>
                                    <option value="tail_one_right">One tail (Right)</option>
                                </select>

                                <br />
                                <!---
<label for="p_value">Choose the confidence interval:</label>
<select id="ci_value">
  <option value="95">.95</option>
  <option value="90">.90</option>
  <option value="99">.99</option>
  <option value="0">I don't need one</option>
</select>
    </form>
<br />
--->
                                <button class="btn btn-outline-primary" id="generatetable" type="button"
                                    onclick="generateTable()">Generate data entry table</button>
                            </form>
                        </div>
                    </div>
                </div>

                <div id="step2_instructions"></div>
                <div id="step2_output"></div>
                <div id="step3_output" class="card">
                    <div class="card-body">
                        <div class="descriptive" id="descriptive_output"></div>
                        <div class="variance" id="variance_output"></div>
                        <div class="output" id="output"></div>
                        <div class="test_of_significance" id="test_of_significance_output"></div>
                        <div class="conclusion" id="conclusion_output"></div>
                    </div>
                </div>
                <div id="resources" class="card mt-2">
                    <div class="card-body">
                        <div id="resources_content">
                            <h5>Thanks for trying out my statistical calculator!</h5>
                            <p>Click <a href="https://full-stack-john.github.io/projects/simplestatistics.html">here</a> to perform another
                                calculation. I have plans of further developing this application to include more tests,
                                a native smartphone application version, and basic graphical representation features.
                                For now, here are some resources for further learning:</p>
                            <h5>Resources</h5>
                            <ul>
                                <li><a href="https://www.r-project.org/">R</a>
                                </li>
                                <li><a href="https://rstudio.com/">R Studio</a>
                                </li>
                                <li><a href="https://online-learning.harvard.edu/course/data-science-r-basics?delta=0">R
                                        Basics (Harvard's beginner open-online course)</a>
                                </li>
                                <li><a href="https://www.coursera.org/learn/r-programming">R Programming (John Hopkins'
                                        beginner open-online course)</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div class="row justify-content-center text-right">
            <div class="footer bg-dark p-3 text-light">
                <a href="https://full-stack-john.github.io" class="text-light">Return to full-stack-john.github.io</a>
            </div>
        </div>
    </div>

    <style>
        .descriptive div {
            float: left;
            width: 100px;
        }

        .descriptive_conclusion {
            float: left;
            width: 400px !important;
        }

        .output div {
            float: left;
            width: 200px;
        }

        .test_of_significance div {
            float: left;
            width: 250px;
        }

        .conclusion div {
            float: left;
            width: auto;
        }

        .variance div {
            float: left;
            width: auto;
        }

        /*
    div#paired_output {display: none;}
    div#one_output {display: none;}
    div#independent_output {display: none;}
    */

        textarea.form-control {
            background: url(images/stats/tablebg.png);
            background-attachment: local;
            background-repeat: no-repeat;
            padding-bottom: 0;
            padding-left: 35px;
            padding-top: 12px;
            border-color: #ccc;
            font-size: 10px;
            line-height: 16px;
            resize: none;
            width: 100px;
        }

        .myForm {
            float: left;
            margin-right: 5px;
        }
    </style>



    <script>
        let test_parameters = [];
        console.log(test_parameters);

        function generateTable() {
            let x = document.forms["myForm"]["group_size"].value;
            if (x == "" || isNaN(x) || x < 0 || x == 0 || x > 100) {
                alert("The largest group size must filled out AND must be an interger. Greatest number of participants per group supported is restricted to 100.");
                return false;
            }



            // Append values to object
            //test_parameters.push({"total":document.getElementById("total").value});
            test_parameters.push({ "group": document.getElementById("group").value });
            // The above two are for generation table and input for the calculation
            test_parameters.push({ "test_type": document.getElementById("test_type").value });
            // - This affects the t-crit calculation
            test_parameters.push({ "p_value": document.getElementById("p_value").value });
            // - This tests whether it is significant or not
            test_parameters.push({ "tail_type": document.getElementById("tail_type").value });
            // - This affects the t-crit calculation
            //test_parameters.push({"ci_value":document.getElementById("ci_value").value});
            // - This is an additional post-hoc analysis
            console.log(test_parameters);
            //functionName(); // Testing if it exists outside of loop
            document.getElementById("description_hello").style.display = "none";
            document.getElementById("step1_instructions").style.display = "none";
            document.getElementById("step2_instructions").innerHTML = "<b>Instructions:</b> Fill in the form below with your data. Only numbers are permitted (decimals are optional and also accepted). Each new entry should be identified with a new line (return/enter key), and not a comma.<br /><br />";
            const element = document.getElementById("step2_output");

            const EntryCardContainer = document.createElement("div");
            EntryCardContainer.setAttribute("class", "card");
            element.appendChild(EntryCardContainer);

            const EntryContainer = document.createElement("div");
            EntryContainer.setAttribute("class", "card-body");
            EntryContainer.setAttribute("id", "input_card_form");
            EntryCardContainer.appendChild(EntryContainer);

            const dataEntryForm = document.createElement("FORM");
            dataEntryForm.setAttribute("id", "myForm");
            //class="row justify-content-center"
            dataEntryForm.setAttribute("class", "row justify-content-center");
            EntryContainer.appendChild(dataEntryForm);

            // Develop a loop for first column to display row count ??
            let input_size = document.getElementById("group").value;

            const InputOneContainer = document.createElement("div");
            //InputOneContainer.innerHTML = "Group 1";
            InputOneContainer.setAttribute("style", "float:left; width:100px; margin-right:5px;");
            InputOneContainer.setAttribute("id", "group_1_input_container");
            //InputOneContainer.setAttribute("class","card");
            dataEntryForm.appendChild(InputOneContainer);

            const InputOneContainerTitle = document.createElement("div");
            InputOneContainerTitle.innerHTML = "Group 1";
            InputOneContainerTitle.setAttribute("id", "group_1_input_title");
            InputOneContainer.appendChild(InputOneContainerTitle);

            const groupInputOne = document.createElement("TEXTAREA");
            groupInputOne.setAttribute("id", "group_1_input");
            groupInputOne.setAttribute("name", "group_1_input");
            groupInputOne.setAttribute("rows", input_size); // # of specified participants
            groupInputOne.setAttribute("cols", "5");
            groupInputOne.setAttribute("class", "form-control");
            //document.getElementById("group_2_input").style.resize = "none";
            InputOneContainer.appendChild(groupInputOne);



            // Only displays if NOT one sample t-test
            if (test_parameters[1]["test_type"] != "one_way") {

                const InputTwoContainer = document.createElement("div");
                //InputTwoContainer.innerHTML = "Group 2";
                //InputOneContainer.setAttribute("class","card");
                dataEntryForm.appendChild(InputTwoContainer);

                const InputTwoContainerTitle = document.createElement("div");
                InputTwoContainerTitle.innerHTML = "Group 2";
                InputTwoContainerTitle.setAttribute("id", "group_2_input_title");
                InputTwoContainer.appendChild(InputTwoContainerTitle);

                const groupInputTwo = document.createElement("TEXTAREA");
                groupInputTwo.setAttribute("id", "group_2_input");
                groupInputTwo.setAttribute("name", "group_2_input");
                groupInputTwo.setAttribute("rows", input_size); // # of specified participants
                groupInputTwo.setAttribute("cols", "5");
                groupInputTwo.setAttribute("class", "form-control");
                groupInputTwo.setAttribute("pattern", "pattern='[0-9.\n]'")
                //document.getElementById("group_2_input").style.resize = "none";
                InputTwoContainer.appendChild(groupInputTwo);

                if (test_parameters[1]["test_type"] === "paired") {
                    document.getElementById("group_1_input_title").innerHTML = "Pre-test";
                    document.getElementById("group_2_input_title").innerHTML = "Post-test";
                }
            } else if (test_parameters[1]["test_type"] === "one_way") {

                document.getElementById("myForm").style.display = "block";
                document.getElementById("group_1_input_title").innerHTML = "Sample data";
                const clearDiv = document.createElement("div");
                clearDiv.innerHTML = "<div style='clear:both;' />";
                document.getElementById("myForm").style.display = "grid";
                document.getElementById("myForm").style.textAlign = "center";
                document.getElementById("group_1_input_container").style.margin = "0px 0px 0px 85px";
                //document.getElementById("myForm").style.text-align = "0 0 33% 0";

                const groupInputInstruction = document.createElement("div");
                groupInputInstruction.setAttribute("id", "group_mean");
                groupInputInstruction.innerHTML = "Please enter the population mean below:";

                const groupInputTwo = document.createElement("input");
                groupInputTwo.setAttribute("id", "group_2_input");
                groupInputInstruction.setAttribute("name", "group_2_input");
                //groupInputTwo.setAttribute("rows", "20"); // # of specified participants
                //groupInputTwo.setAttribute("cols", "5");
                document.getElementById("myForm").appendChild(clearDiv);
                document.getElementById("myForm").appendChild(groupInputInstruction);
                document.getElementById("myForm").appendChild(groupInputTwo);
            }
            else {
            }

            const InputSubmitContainer = document.createElement("div");
            InputSubmitContainer.setAttribute("class", "justify-content-center text-center");
            document.getElementById("input_card_form").appendChild(InputSubmitContainer);


            const generateEntrySubmit = document.createElement("input");
            generateEntrySubmit.setAttribute("type", "button");
            generateEntrySubmit.setAttribute("onclick", "submitStudyData()");
            generateEntrySubmit.setAttribute("value", "Perform statistical analysis");
            generateEntrySubmit.setAttribute("class", "btn btn-outline-primary");
            InputSubmitContainer.appendChild(generateEntrySubmit);

            // Remove the "Generate entry" and a check to ensure you can only click it once
            document.getElementById("generatetable").remove();

            /*
            Store all variables into an object
            
            test_type = one way, two way, etc.
            p_value = .05, .01, etc.
            tail_type = one tail, two tail
            ci_value = .90, .95, .99
            total = total N
            group = max size of a given group
            */

        }

        function functionName() {
            console.log(test_parameters);
        }

        //console.log(test_parameters);
        let arraygroupOneInput = [];
        let arraygroupTwoInput = [];

        function submitStudyData() { // This pushes the data input into the correct statistical calculations according to the test paramters
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                document.getElementById("viewport").setAttribute("content", "width=700, initial-scale=0, maximum-scale=1.0, minimum-scale=0.6, user-scalable=yes");
                //document.body.style.margin = "0 0 200px 0";
            }

            let x0 = document.forms["myForm"]["group_1_input"].value;
            let numbers = /^[\d.?]$/gm;
            let blacklist = /[a-mo-zA-Z!@#$%^&*,=<>()\/?_`~+\]\[-]/gm;
            let blacklist2 = /\d+(\.\d+\.)/gm;
            let blacklist3 = /\d+(\.\D*\D)/gm;

            if (test_parameters[1]["test_type"] === "one_way") {
                let x2 = document.forms["myForm"]["group_2_input"].value;
                // Check Group Mean

                if (x0.match(blacklist) || x0.match(blacklist2) || x0.match(blacklist3) || x0 === "") {
                    alert("Please check your sample scores. Please make sure you've filled out the data entry columns. Please enter only numbers (and decimals if necessary). Each new entry should be a new row. Do not add any commas.");
                    return false;
                } else if (x2 == "" || isNaN(x2) || x2 < 0 || x2 == 0) {
                    alert("Please make sure you fill out the population mean. Only numbers are accepted.");
                    return false;
                }

            } else {

                let x1 = document.forms["myForm"]["group_2_input"].value;

                if (x0.match(blacklist) || x0.match(blacklist2) || x0.match(blacklist3) || x0 === "") {
                    alert("Please check Group 1. Please make sure you've filled out the data entry columns. Please enter only numbers (and decimals if necessary). Each new entry should be a new row. Do not add any commas.");
                    return false;
                } else if (x1.match(blacklist) || x1.match(blacklist2) || x1.match(blacklist3) || x1 === "") {
                    alert("Please check Group 2. Please make sure you've filled out the data entry columns. Please enter only numbers (and decimals if necessary). Each new entry should be a new row. Do not add any commas.");
                    return false;
                }
                else if (x1.match(numbers) && x0.match(numbers)) {
                }
            }

            /*
            if (x1.match(letters)) {
                alert("No letters");
                return false;
            } else if (x1 == "") {
                alert("Please ensure your input includes intergers, no punctuation");
                return false;
            } else if (x1.match(numbers)) {
                //do nothing
            }*/

            // Hide earlier steps
            document.getElementById("step2_instructions").style.display = "none";
            document.getElementById("step2_output").style.display = "none";
            document.getElementById("step3_output").style.display = "flex";

            groupOneInput = document.getElementById("group_1_input").value;


            //let arraygroupOneInput = [];
            arraygroupOneInput = groupOneInput.split(`\n`); // Make sure this validates and checks for numbers

            console.log(arraygroupOneInput);
            //let arraygroupTwoInput = [];


            // Perform statistical analysis for the array
            if (test_parameters[1]["test_type"] === "one_way") {
                groupTwoInput = document.getElementById("group_2_input").value;
                //document.getElementById("one_output").style.display = "initial";
                computetStatistic_one_way();
                console.log("This is a one way test");
            } else if (test_parameters[1]["test_type"] === "paired") {
                //differenceFunction();
                groupTwoInput = document.getElementById("group_2_input").value;
                //document.getElementById("paired_output").style.display = "initial";
                arraygroupTwoInput = groupTwoInput.split(`\n`); // Make sure this validates and checks for numbers
                computetStatistic_paired();
                console.log("This is paired test");
            } else if (test_parameters[1]["test_type"] === "independent") {
                groupTwoInput = document.getElementById("group_2_input").value;
                //document.getElementById("independent_output").style.display = "initial";
                arraygroupTwoInput = groupTwoInput.split(`\n`); // Make sure this validates and checks for numbers
                computetStatistic_independent();
                console.log("This is an independent test");
            } else {
                console.log("Not specified");
            }

            // Compare the t statistic to the t-crit value

            // Determine if significant based on p-value
            if (test_parameters[2]["p_value"] === "10") {
                console.log("This is a .10");
            } else if (test_parameters[2]["p_value"] === "05") {
                console.log("This is a .05");
            } else if (test_parameters[2]["p_value"] === "01") {
                console.log("This is a .01");
            } else if (test_parameters[2]["p_value"] === "001") {
                console.log("This is a .001");
            } else {
                console.log("Not specified");
            }

            // Calculate the effect size and CI
            //createOutput();
            document.getElementById("resources").style.display = "flex";
        }

    </script>
</body>

</html>